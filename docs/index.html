<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fractal Reality</title>
    <meta name="description" content="A complete mathematical framework unifying quantum mechanics, general relativity, and consciousness through validation at interfaces in 3.5D spacetime.">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@300;400;600&family=IBM+Plex+Mono:wght@400;500&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Crimson Pro', Georgia, serif;
            background: #0a0a0a;
            color: #e8e8e8;
        }
        
        .viewport {
            width: 100vw;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .simulator-viewport {
            background: #0a0a0a;
        }
        
        .diagram-viewport {
            background: #0a0a0a;
        }
        
        .simulator-container {
            width: 90vw;
            height: 90vh;
            max-width: 1400px;
            border: 1px solid rgba(255,255,255,0.08);
        }
        
        .simulator-container iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        .diagram-container {
            width: 100%;
            height: 100%;
        }
        
        .footer-link {
            padding: 2rem;
            text-align: center;
            border-top: 1px solid rgba(255,255,255,0.08);
        }
        
        .footer-link a {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 0.875rem;
            color: #e8e8e8;
            text-decoration: none;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            transition: border-color 0.2s;
        }
        
        .footer-link a:hover {
            border-bottom-color: rgba(255,255,255,0.6);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const FractalRealityLanding = () => {
            const [previewSim, setPreviewSim] = useState(null);

            useEffect(() => {
                const fetchPreviewSim = async () => {
                    try {
                        const response = await fetch('./sims.md');
                        if (!response.ok) return;
                        
                        const markdown = await response.text();
                        const lines = markdown.split('\n');
                        
                        for (const line of lines) {
                            const trimmed = line.trim();
                            if (!trimmed || trimmed.startsWith('#') || trimmed.startsWith('//')) continue;
                            
                            let filename = null;
                            const linkMatch = trimmed.match(/\[.*?\]\((.*?\.tsx)\)/);
                            if (linkMatch) {
                                filename = linkMatch[1];
                            } else if (trimmed.match(/^[-*]\s+/)) {
                                const listMatch = trimmed.match(/[-*]\s+(.*?\.tsx)/);
                                if (listMatch) filename = listMatch[1];
                            } else if (trimmed.endsWith('.tsx')) {
                                filename = trimmed;
                            }
                            
                            if (filename) {
                                filename = filename.replace(/^simulations\//, '');
                                setPreviewSim(filename);
                                break;
                            }
                        }
                    } catch (err) {
                        console.log('Preview not loaded');
                    }
                };

                fetchPreviewSim();
            }, []);

            return (
                <div>
                    {/* First Viewport: Simulator */}
                    <div className="viewport simulator-viewport">
                        <div className="simulator-container">
                            {previewSim ? (
                                <iframe 
                                    src={`./simulators.html?auto=${previewSim}`}
                                    title="Fractal Reality Simulation"
                                />
                            ) : (
                                <div style={{display: 'flex', alignItems: 'center', justifyContent: 'center', height: '100%'}}>
                                    <div style={{fontFamily: 'IBM Plex Mono, monospace', fontSize: '0.875rem', color: '#606060'}}>
                                        Loading simulation...
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>

                    {/* Second Viewport: Diagram */}
                    <div className="viewport diagram-viewport">
                        <div className="diagram-container">
                            <iframe 
                                src="./simulations/fractal-reality-diagram-dark.jsx"
                                title="Fractal Reality Diagram"
                                style={{width: '100%', height: '100%', border: 'none'}}
                            />
                        </div>
                    </div>

                    {/* Footer: GitHub Link */}
                    <div className="footer-link">
                        <a 
                            href="https://github.com/AshmanRoonz/Fractal_Reality" 
                            target="_blank"
                            rel="noopener noreferrer"
                        >
                            github.com/AshmanRoonz/Fractal_Reality
                        </a>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<FractalRealityLanding />);
    </script>
</body>
</html>
